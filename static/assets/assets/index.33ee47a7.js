import{d as e,e as a,r as l,A as s,B as t,E as o,aM as i,aG as r,aF as d,aL as u,u as c,D as n,aI as m,aT as v,aJ as p,b0 as f,b1 as _,b2 as b,b3 as g,b4 as y,aU as h,b5 as x,b6 as k,b7 as V,aZ as j,b8 as q,b9 as w}from"./arco.6fa229d2.js";import{F as C}from"./index.aa55ef39.js";import{g as U,l as D,s as I,a as z,b as F,_ as L}from"./index.663b2955.js";/* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               */import{e as P}from"./vue.17197c5c.js";import{C as R}from"./index.e56c8e5e.js";import"./chart.f78d3971.js";import"./_commonjs-dynamic-modules.30ae7933.js";const W={class:"login-form-wrapper"},B=(e=>(q("data-v-2c487f25"),e=e(),w(),e))((()=>o("div",{class:"login-form-title"},"登录 LDDP",-1))),M={class:"login-form-error-msg"},O={class:"login-form-password-actions"},S={style:{"text-align":"center"}},A=L(e({__name:"login-form",setup(e){const q=P(),w=a(""),C=l({email:"",user_key:"",id:"",capt:"",is_save:!1}),L=l({id:"",bs64:""}),A=l({email:"",user_key:"",vf_code:"",is_save:!1}),E=a(!1),G=a(!1),J=a(!1);if(localStorage.getItem("token")){const{redirect:e,...a}=q.currentRoute.value.query;q.push({name:e||"Workplace",query:{...a}})}const T=()=>{U().then((e=>{L.id=e.data.id,L.bs64=e.data.bs64}))};T();const Z=()=>{E.value=!0},H=()=>{E.value=!1},K=()=>{const e={email:C.email,user_key:Y(C.user_key),id:L.id,capt:C.capt,is_save:C.is_save};D(e).then((e=>{if(2e3===e.code){v.success("欢迎使用"),I(e.data.token),E.value=!1;const{redirect:a,...l}=q.currentRoute.value.query;q.push({name:a||"Workplace",query:{...l}})}else 5014===e.code&&(E.value=!1,G.value=!0)})).catch((()=>{E.value=!1,C.capt="",T()}))},N=()=>{G.value=!1},Q=()=>{if(""===A.vf_code)return void v.error("请输入验证码");const e={email:C.email,user_key:Y(C.user_key),vf_code:A.vf_code,is_save:C.is_save};z(e).then((e=>{if(2e3===e.code){v.success("欢迎使用"),I(e.data),G.value=!1;const{redirect:a,...l}=q.currentRoute.value.query;q.push({name:a||"Workplace",query:{...l}})}})).catch((()=>{A.vf_code=""}))},X=()=>{if(""===C.email)return void v.error("请输入邮箱");if(""===C.user_key)return void v.error("请输入密码");const e={email:C.email};J.value=!0,F(e).then((e=>{2e3===e.code&&v.success("发送成功")})).catch((()=>{J.value=!1,A.vf_code=""}))},Y=e=>R.MD5(e).toString();return(e,a)=>{const l=p("icon-email"),v=f,U=_,D=p("icon-lock"),I=b,z=g,F=y,P=h,R=x,Y=k,$=V,ee=j;return s(),t(m,null,[o("div",W,[B,o("div",M,i(w.value),1),r(Y,{ref:"loginForm",model:C,class:"login-form",layout:"vertical"},{default:d((()=>[r(U,{field:"email",rules:[{required:!0,message:"邮箱不能为空"}],"validate-trigger":["change","blur"],"hide-label":""},{default:d((()=>[r(v,{modelValue:C.email,"onUpdate:modelValue":a[0]||(a[0]=e=>C.email=e),placeholder:"邮箱"},{prefix:d((()=>[r(l)])),_:1},8,["modelValue"])])),_:1}),r(U,{field:"user_key",rules:[{required:!0,message:"密码不能为空"}],"validate-trigger":["change","blur"],"hide-label":""},{default:d((()=>[r(I,{modelValue:C.user_key,"onUpdate:modelValue":a[1]||(a[1]=e=>C.user_key=e),placeholder:"密码","allow-clear":""},{prefix:d((()=>[r(D)])),_:1},8,["modelValue"])])),_:1}),r(R,{size:16,direction:"vertical"},{default:d((()=>[o("div",O,[r(z,{modelValue:C.is_save,"onUpdate:modelValue":a[2]||(a[2]=e=>C.is_save=e),checked:"rememberPassword"},{default:d((()=>[u(" 7天免登录 ")])),_:1},8,["modelValue"]),r(F,{onClick:a[3]||(a[3]=e=>c(q).push({name:"forget"}))},{default:d((()=>[u("找回密码")])),_:1})]),r(P,{type:"primary","html-type":"submit",long:"",onClick:Z},{default:d((()=>[u(" 登录 ")])),_:1}),r(P,{type:"text",long:"",class:"login-form-register-btn",style:{"margin-bottom":"20px"},onClick:a[4]||(a[4]=e=>c(q).push({name:"register"}))},{default:d((()=>[u(" 注册账户 ")])),_:1})])),_:1})])),_:1},8,["model"])]),r(ee,{visible:E.value,"onUpdate:visible":a[6]||(a[6]=e=>E.value=e),width:"350px",title:"请输入验证码，确保您不是机器人",onCancel:H,onOk:K},{default:d((()=>[r(Y,{model:C,layout:"vertical"},{default:d((()=>[o("div",S,[r(F,{onClick:T},{default:d((()=>[o("div",{style:n([{width:"200px",height:"64px"},{backgroundImage:"url("+L.bs64+")"}])},null,4)])),_:1})]),r($),r(U,{field:"capt",label:"验证码",rules:[{required:!0,message:"验证码不能为空"}],"validate-trigger":["change","blur"]},{default:d((()=>[r(v,{modelValue:C.capt,"onUpdate:modelValue":a[5]||(a[5]=e=>C.capt=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"]),r(ee,{visible:G.value,"onUpdate:visible":a[8]||(a[8]=e=>G.value=e),title:"需要验证登录身份",width:"350px",onCancel:N,onBeforeOk:Q},{default:d((()=>[r(Y,{model:A,layout:"vertical"},{default:d((()=>[r(P,{type:"outline",style:{display:"block",width:"150px",margin:"0 auto 12px","text-align":"center"},"html-type":"submit",disabled:J.value,onClick:X},{default:d((()=>[u(" 发送邮箱验证码 ")])),_:1},8,["disabled"]),r(U,{field:"name",label:"邮箱验证码"},{default:d((()=>[r(v,{modelValue:A.vf_code,"onUpdate:modelValue":a[7]||(a[7]=e=>A.vf_code=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"])],64)}}}),[["__scopeId","data-v-2c487f25"]]),E={style:{background:"url('https://pic.6b7.xyz/2023/01/24/xd.svg') no-repeat fixed\n        right bottom"}},G={class:"container"},J=(e=>(q("data-v-858f9754"),e=e(),w(),e))((()=>o("div",{class:"logo"},[o("img",{alt:"logo",src:"https://pic.6b7.xyz/2023/02/28/98ad89022a0b2.ico"}),o("div",{class:"logo-text",style:{color:"#598bff"}},"LDDP")],-1))),T={class:"content"},Z={class:"content-inner",style:{"background-color":"white","border-radius":"20px",opacity:"0.9"}},H={class:"footer"},K=L(e({__name:"index",setup:e=>(e,a)=>(s(),t("div",E,[o("div",G,[J,o("div",T,[o("div",Z,[r(A)]),o("div",H,[r(C)])])])]))}),[["__scopeId","data-v-858f9754"]]);export{K as default};
